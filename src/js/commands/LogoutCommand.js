//-------------------------------------------------------------------------------
// Imports
//-------------------------------------------------------------------------------

import {
    Class,
    Obj,
    Promise,
    Proxy
} from 'bugcore';
import AuthController from '../controllers/AuthController';


//-------------------------------------------------------------------------------
// Declare Class
//-------------------------------------------------------------------------------

/**
 * @class
 * @extends {Obj}
 */
const LogoutCommand = Class.extend(Obj, {

    _name: 'recipe.LogoutCommand',


    //-------------------------------------------------------------------------------
    // Constructor
    //-------------------------------------------------------------------------------

    /**
     * @constructs
     */
    _constructor: function() {

        this._super();


        //-------------------------------------------------------------------------------
        // Public Properties
        //-------------------------------------------------------------------------------


    },


    //-------------------------------------------------------------------------------
    // Getters and Setters
    //-------------------------------------------------------------------------------


    //-------------------------------------------------------------------------------
    // Public Methods
    //-------------------------------------------------------------------------------

    /**
     * @param {{
     *      global: boolean?,
     *      project: boolean?
     * }} options
     * @return {Promise}
     */
    run: function(options) {
        return new Promise((resolve, reject) => {
            AuthController
                .logout()
                .then(() => {
                    resolve();
                })
                .catch(function(error) {
                    reject(error);
                });
        });
    }


    //-------------------------------------------------------------------------------
    // Private Methods
    //-------------------------------------------------------------------------------

});


//-------------------------------------------------------------------------------
// Private Static Properties
//-------------------------------------------------------------------------------

/**
 * @static
 * @private
 * @type {LogoutCommand}
 */
LogoutCommand.instance        = null;


//-------------------------------------------------------------------------------
// Static Methods
//-------------------------------------------------------------------------------

/**
 * @static
 * @return {LogoutCommand}
 */
LogoutCommand.getInstance = function() {
    if (LogoutCommand.instance === null) {
        LogoutCommand.instance = new LogoutCommand();
    }
    return LogoutCommand.instance;
};


//-------------------------------------------------------------------------------
// Static Proxy
//-------------------------------------------------------------------------------

Proxy.proxy(LogoutCommand, Proxy.method(LogoutCommand.getInstance), [
    'run'
]);


//-------------------------------------------------------------------------------
// Exports
//-------------------------------------------------------------------------------

module.exports = LogoutCommand;
